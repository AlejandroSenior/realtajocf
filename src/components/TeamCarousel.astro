---
const players = [
  { name: 'Josu', image: '/images/players/josu.webp' },
  { name: 'Senior', image: '/images/players/senior.webp' },
  { name: 'Ovejero', image: '/images/players/ove.webp' },
  { name: 'Finho', image: '/images/players/finho.webp' },
  { name: 'Marín Jr Jr', image: '/images/players/marin-jr-jr.webp' },
  { name: 'Marín', image: '/images/players/marin.webp' },
  { name: 'Cortés', image: '/images/players/cortes.webp' },
  { name: 'Cermeño', image: '/images/players/cermeno.webp' },
  { name: 'H. Cordero', image: '/images/players/cordero.webp' },
  { name: 'Jaime', image: '/images/players/jaime.webp' },
  { name: 'Molina', image: '/images/players/molina.webp' },
  { name: 'Coke', image: '/images/players/coke.webp' },
  { name: 'Marín Jr', image: '/images/players/marin-jr.webp' },
  { name: 'Pallero', image: '/images/players/pallero.webp' },
  { name: 'Gil', image: '/images/players/gil.webp' },
  { name: 'Lianes', image: '/images/players/lianes.webp' },
  { name: 'Pacheco', image: '/images/players/pacheco.webp' }
];
---

<script>
  import Swiper from 'swiper';
  import { Autoplay } from 'swiper/modules';

  let swiper: Swiper | null = null;
  let resizeTimeout: NodeJS.Timeout;

  const shuffleSlides = () => {
    const wrapper = document.querySelector('.swiper-wrapper') as HTMLElement;
    const slides = Array.from(wrapper.children);
    const shuffled = slides.sort(() => Math.random() - 0.5);
    shuffled.forEach((slide) => wrapper.appendChild(slide));
  };

  const initSwiper = () => {
    if (swiper) {
      swiper.destroy(true, true);
    }

    shuffleSlides();

    swiper = new Swiper('.mySwiper', {
      modules: [Autoplay],
      loop: true,
      spaceBetween: 40,
      slidesPerView: 'auto',
      centeredSlides: true,
      autoplay: {
        delay: 0,
        disableOnInteraction: false,
        pauseOnMouseEnter: true
      },
      speed: 3000
    });
  };

  const handleResize = () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      if (swiper) {
        swiper.update();
      }
    }, 250);
  };

  window.addEventListener('load', initSwiper);
  window.addEventListener('resize', handleResize);
</script>

<div class="swiper mySwiper">
  <div class="swiper-wrapper">
    {
      players.map((player) => (
        <div class="swiper-slide border-5 border-secondary rounded-3xl bg-white max-w-[200px] md:max-w-[400px] aspect-[3/4] relative overflow-hidden">
          <img src={player.image} alt={player.name} class="w-full h-full object-cover" />
          <div class="player-info absolute bottom-0 left-0 right-0 h-[33%] flex items-end justify-center pb-3">
            <div class="text-sm md:text-5xl text-white text-center font-bold mb-5">{player.name}</div>
          </div>
        </div>
      ))
    }
  </div>
</div>

<style>
  .swiper {
    background: linear-gradient(to top, white 50%, var(--color-primary) 100%);
  }

  .player-info {
    background: linear-gradient(to top, var(--color-primary) 10%, transparent 100%);
  }

  @media (width <= 768px) {
    .swiper-slide {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 18px;
    }
  }
</style>
